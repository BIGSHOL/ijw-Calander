# 연간 일정 탭 업그레이드 기획 보고서

**작성일**: 2026-01-09
**버전**: 1.0
**상태**: 기획 단계

---

## 1. 개요

현재 연간 일정 탭을 학원 설명회 관리에 특화된 시스템으로 업그레이드합니다.
핵심 기능은 **해시태그 기반 이벤트 분류**와 **설명회 참석자 데이터 관리**입니다.

---

## 2. 요구사항 분석

### 2.1 해시태그 기능 추가

| 기능 | 설명 | 우선순위 |
|------|------|----------|
| 커스텀 해시태그 | `#설명회`, `#정기시험`, `#방학특강` 등 사용자 정의 태그 | P0 |
| 검색 시 연간뷰 빈도 확인 | 태그별 이벤트 수를 월별/연간 히트맵으로 시각화 | P1 |
| 인원 확인 | 태그별 총 참석자 수 집계 | P1 |
| 기본틀 설정 | 자주 사용하는 태그 프리셋 관리 | P2 |

### 2.2 설명회 데이터화

| 데이터 항목 | 설명 | 필수 여부 |
|-------------|------|----------|
| **참석자 정보** | | |
| - 학생 연령 | 유아/초등/중등/고등 | 필수 |
| - 주소 | 거주 지역 (동/구 단위) | 선택 |
| - 전화번호 | 연락처 | 필수 |
| - 신청경로 | 블로그/인스타/지인소개/현수막/기타 | 필수 |
| - 성비 | 남/여 자동 집계 | 자동 |
| - 부모 정보 | 부모 연락처, 직업군 (선택) | 선택 |
| **동석자** | 형제/자매, 부모, 기타 | 선택 |
| **연사** | 설명회 진행 강사 | 필수 |
| **담당선생님** | 상담/등록 담당자 | 필수 |
| **설명회 일시** | 날짜, 시작시간, 종료시간 | 필수 |

---

## 3. 시스템 설계

### 3.1 데이터 모델

```typescript
// 해시태그
interface EventTag {
  id: string;
  name: string;           // "#설명회"
  color: string;          // 태그 색상
  isDefault: boolean;     // 기본 태그 여부
  createdAt: number;
}

// 설명회 이벤트 (CalendarEvent 확장)
interface SeminarEvent extends CalendarEvent {
  type: 'seminar';
  tags: string[];         // 해시태그 ID 배열
  speaker: string;        // 연사 ID
  manager: string;        // 담당선생님 ID
  attendees: SeminarAttendee[];
  maxCapacity?: number;   // 최대 인원
}

// 설명회 참석자
interface SeminarAttendee {
  id: string;
  seminarId: string;

  // 학생 정보
  studentName: string;
  studentAge: 'infant' | 'elementary' | 'middle' | 'high';
  studentGrade?: string;  // 구체적 학년
  gender: 'male' | 'female';

  // 연락처
  phone: string;
  address?: string;
  district?: string;      // 동/구

  // 신청 정보
  registrationSource: 'blog' | 'instagram' | 'referral' | 'banner' | 'naver' | 'other';
  sourceDetail?: string;  // 기타 상세

  // 부모 정보
  parentName?: string;
  parentPhone?: string;
  parentRelation?: 'mother' | 'father' | 'guardian';

  // 동석자
  companions: {
    name: string;
    relation: 'sibling' | 'parent' | 'other';
  }[];

  // 상태
  status: 'registered' | 'attended' | 'no_show' | 'cancelled';
  registeredAt: number;
  attendedAt?: number;

  // 후속 조치
  followUpStatus?: 'pending' | 'contacted' | 'enrolled' | 'declined';
  notes?: string;
}
```

### 3.2 Firestore 컬렉션

```
/event_tags            - 해시태그 목록
/calendar_events       - 기존 이벤트 (type: 'seminar' 추가)
/seminar_attendees     - 설명회 참석자 (seminarId로 연결)
```

### 3.3 UI 컴포넌트 구조

```
components/Calendar/
├── CalendarBoard.tsx           (기존 - 수정)
├── EventModal.tsx              (기존 - 확장)
├── Seminar/
│   ├── SeminarEventModal.tsx   (설명회 전용 모달)
│   ├── AttendeeForm.tsx        (참석자 등록 폼)
│   ├── AttendeeList.tsx        (참석자 목록)
│   ├── AttendeeStats.tsx       (참석자 통계)
│   └── TagManager.tsx          (해시태그 관리)
├── Tags/
│   ├── TagFilter.tsx           (태그 필터 UI)
│   ├── TagHeatmap.tsx          (태그별 빈도 히트맵)
│   └── TagStats.tsx            (태그별 통계)
```

---

## 4. 기능 상세

### 4.1 해시태그 시스템

#### 태그 생성/관리
- 설정 모달에서 기본 태그 관리
- 이벤트 생성 시 새 태그 즉시 추가 가능
- 태그별 색상 지정

#### 태그 검색/필터
- 상단 필터 바에 태그 칩 표시
- 클릭 시 해당 태그 이벤트만 필터링
- 여러 태그 복합 필터 지원 (AND/OR)

#### 연간 히트맵
- 월별 태그 빈도를 색상 강도로 표시
- GitHub 컨트리뷰션 그래프 스타일
- 마우스 오버 시 상세 카운트 표시

### 4.2 설명회 참석자 관리

#### 참석자 등록
1. 설명회 이벤트 클릭
2. "참석자 추가" 버튼
3. 참석자 정보 입력 폼
   - 필수: 이름, 연령대, 전화번호, 신청경로
   - 선택: 주소, 부모정보, 동석자
4. 저장 시 자동으로 통계 업데이트

#### 참석자 목록
- 설명회별 참석자 테이블
- 상태별 필터 (등록/참석/노쇼/취소)
- 엑셀 내보내기 지원

#### 통계 대시보드
```
[설명회 통계]
┌─────────────┬─────────────┬─────────────┐
│ 총 참석자   │ 실제 참석   │ 등록 전환   │
│    45명     │   38명(84%) │   12명(32%) │
└─────────────┴─────────────┴─────────────┘

[신청 경로 분석]
┌──────────────────────────────────────────┐
│ 블로그 ████████████ 40%                  │
│ 인스타 ████████ 30%                      │
│ 지인소개 ████ 15%                        │
│ 현수막 ██ 10%                            │
│ 기타 █ 5%                                │
└──────────────────────────────────────────┘

[연령대 분포]
┌──────────────────────────────────────────┐
│ 초등: 25명 | 중등: 15명 | 고등: 5명      │
└──────────────────────────────────────────┘

[지역 분포]
- 상위 5개 지역 표시
```

---

## 5. 구현 계획

### Phase 1: 해시태그 기본 (P0)
1. EventTag 타입 및 Firestore 설정
2. CalendarEvent에 tags 필드 추가
3. 이벤트 모달에 태그 선택 UI
4. 상단 필터 바에 태그 필터 추가

### Phase 2: 설명회 이벤트 (P0)
1. SeminarEvent 타입 정의
2. SeminarAttendee 타입 정의
3. 설명회 전용 모달 생성
4. 참석자 등록 폼 구현

### Phase 3: 참석자 관리 (P1)
1. 참석자 목록 UI
2. 상태 관리 (등록/참석/노쇼)
3. 후속 조치 추적
4. 엑셀 내보내기

### Phase 4: 통계/분석 (P1)
1. 신청 경로 분석 차트
2. 연령대/성별 분포
3. 지역별 분포
4. 등록 전환율 추적

### Phase 5: 고급 기능 (P2)
1. 태그별 히트맵 시각화
2. 기본 템플릿 설정
3. 참석자 중복 체크 (기존 학생 연동)
4. SMS/알림톡 연동 (선택)

---

## 6. UI 와이어프레임

### 6.1 연간 일정 메인 (개선)

```
┌──────────────────────────────────────────────────────────────┐
│ [📅 일정] [📊 간트] │ [🏷️ #설명회] [#정기시험] [#방학특강] [+] │
├──────────────────────────────────────────────────────────────┤
│                                                              │
│  2026년                                    [< 이전] [다음 >] │
│                                                              │
│  ┌─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┐    │
│  │ 1월 │ 2월 │ 3월 │ 4월 │ 5월 │ 6월 │ 7월 │ 8월 │ ... │    │
│  ├─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┼─────┤    │
│  │ 📌2 │ 📌1 │ 📌3 │ 📌2 │ 📌1 │ 📌2 │ 📌4 │ 📌3 │     │    │
│  │     │     │     │     │     │     │     │     │     │    │
│  └─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┘    │
│                                                              │
│  📌 설명회 빈도 히트맵 (클릭 시 상세)                         │
│                                                              │
└──────────────────────────────────────────────────────────────┘
```

### 6.2 설명회 상세 모달

```
┌─────────────────────────────────────────────────────────────┐
│ 📅 1월 신입생 설명회                              [X 닫기]  │
├─────────────────────────────────────────────────────────────┤
│ 🏷️ #설명회 #신입생 #초등                                    │
│                                                             │
│ 📆 2026-01-15 (토) 14:00 - 16:00                           │
│ 👨‍🏫 연사: 김원장                                            │
│ 👩‍💼 담당: 박선생                                            │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│ [참석자 목록] [통계] [설정]                                  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ 참석자 (12/20명)                        [+ 참석자 추가]     │
│                                                             │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 이름    │ 연령 │ 전화번호     │ 경로   │ 상태  │ 조치  │ │
│ ├─────────┼──────┼──────────────┼────────┼───────┼───────┤ │
│ │ 김민수  │ 초5  │ 010-xxxx-xxxx│ 블로그 │ ✅참석│ 등록  │ │
│ │ 이서연  │ 초4  │ 010-xxxx-xxxx│ 인스타 │ ✅참석│ 상담중│ │
│ │ 박지훈  │ 초6  │ 010-xxxx-xxxx│ 지인   │ ❌노쇼│ -    │ │
│ └─────────┴──────┴──────────────┴────────┴───────┴───────┘ │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 6.3 참석자 등록 폼

```
┌─────────────────────────────────────────────────────────────┐
│ 참석자 등록                                       [X 닫기]  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ 학생 정보                                                   │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 이름 *        [            ]                            │ │
│ │ 연령대 *      (○)초등 (○)중등 (○)고등                   │ │
│ │ 학년          [ 선택 ▼]                                 │ │
│ │ 성별 *        (○)남 (○)여                               │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ 연락처                                                      │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 전화번호 *    [010-    -    ]                           │ │
│ │ 주소          [                          ]              │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ 신청 경로 *                                                 │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ [블로그] [인스타] [지인소개] [현수막] [네이버] [기타]    │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ 동석자 (선택)                                    [+ 추가]   │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 이름 [        ] 관계 [형제/부모/기타 ▼]                 │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ 부모 정보 (선택)                                            │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 성함 [        ] 연락처 [010-    -    ] 관계 [▼]         │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ 메모                                                        │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ [                                                     ] │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│                                    [취소]  [저장]           │
└─────────────────────────────────────────────────────────────┘
```

---

## 7. 기술적 고려사항

### 7.1 성능
- 참석자 목록 페이지네이션 (50명 단위)
- 태그 필터 시 인덱스 활용
- 통계 데이터 캐싱 (React Query)

### 7.2 보안
- 참석자 개인정보 암호화 고려
- 전화번호 마스킹 표시 옵션
- 역할별 접근 권한 (master/admin만 개인정보 전체 열람)

### 7.3 Firebase 비용
- 참석자 데이터 일괄 조회 최적화
- 통계는 집계 문서로 별도 관리 고려

---

## 8. 예상 일정

| 단계 | 내용 | 예상 작업량 |
|------|------|------------|
| Phase 1 | 해시태그 기본 | 중 |
| Phase 2 | 설명회 이벤트 | 중 |
| Phase 3 | 참석자 관리 | 대 |
| Phase 4 | 통계/분석 | 중 |
| Phase 5 | 고급 기능 | 소 |

---

## 9. 다음 단계

1. **요구사항 확정**: 이 보고서 기반으로 기능 범위 확정
2. **디자인 검토**: UI 와이어프레임 승인
3. **Phase 1 착수**: 해시태그 시스템 구현 시작

---

## 10. 질문사항

구현 전 확인이 필요한 사항:

1. **태그 관리 권한**: 모든 사용자가 태그를 생성할 수 있나요, 아니면 관리자만?
2. **참석자-학생 연동**: 설명회 참석자가 등록되면 자동으로 students 컬렉션에 추가할까요?
3. **알림 기능**: 설명회 전날 참석자에게 알림톡/SMS 발송 기능이 필요한가요?
4. **통계 기간**: 통계 대시보드에서 조회할 기간 범위는? (월별/분기별/연간)
5. **엑셀 양식**: 참석자 목록 내보내기 시 필요한 컬럼 구성은?

---

*이 보고서는 초안이며, 피드백을 바탕으로 수정될 수 있습니다.*
