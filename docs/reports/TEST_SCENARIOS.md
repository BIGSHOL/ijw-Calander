# 학생 데이터 시뮬레이션 모드 - 테스트 시나리오

> 작성일: 2026-01-01
> 예상 소요 시간: 45-60분
> 테스트 담당자: _______________

---

## 🎯 테스트 목표

학생 데이터가 시뮬레이션 모드에서 Draft 컬렉션(`수업목록_draft`)에 격리되어 저장되는지 검증

---

## 📋 사전 준비

- [ ] Firebase Console 접속 가능
- [ ] Master 계정 로그인 가능
- [ ] Admin/Manager 계정 로그인 가능 (권한 테스트용)
- [ ] 개발 서버 실행 중 (`npm run dev`)

---

## 🧪 Test 1: 시뮬레이션 진입 (10분)

### 목적
시뮬레이션 모드 진입 시 학생 데이터가 Draft 컬렉션으로 복사되는지 확인

### 단계

| # | 작업 | 예상 결과 | 통과 |
|---|------|----------|------|
| 1 | Master 계정으로 로그인 | 로그인 성공 | ☐ |
| 2 | 영어 시간표 > 수업 탭 진입 | 수업 목록 표시됨 | ☐ |
| 3 | [시뮬레이션 모드] 토글 ON | 주황색 배경으로 변경 | ☐ |
| 4 | [현재 시간표 가져오기] 클릭 | 확인 다이얼로그 표시 | ☐ |
| 5 | 확인 버튼 클릭 | "성공적으로 가져왔습니다" 알림 | ☐ |
| 6 | Firebase Console > Firestore 확인 | `수업목록_draft` 컬렉션 생성됨 | ☐ |
| 7 | 개발자 콘솔 확인 (F12) | "✅ Student data copied" 로그 | ☐ |

### 검증 포인트
- `수업목록_draft` 문서 수 = `수업목록` 문서 수
- studentList 필드 내용 동일

---

## 🧪 Test 2: StudentModal 데이터 격리 (15분)

### 목적
시뮬레이션 모드에서 추가한 학생이 Live 데이터에 영향을 주지 않는지 확인

### 단계

| # | 작업 | 예상 결과 | 통과 |
|---|------|----------|------|
| 1 | 시뮬레이션 모드 상태 확인 | 주황색 배경 유지 | ☐ |
| 2 | 아무 수업 셀 클릭 | StudentModal 열림 | ☐ |
| 3 | 학생 추가: 이름="테스트학생1" | 입력됨 | ☐ |
| 4 | [저장] 버튼 클릭 | "[시뮬레이션] 저장되었습니다" 알림 | ☐ |
| 5 | Firebase Console에서 `수업목록_draft` 확인 | "테스트학생1" 존재 | ☐ |
| 6 | Firebase Console에서 `수업목록` 확인 | "테스트학생1" **없음** | ☐ |
| 7 | [시뮬레이션 모드] 토글 OFF | 녹색 배경으로 변경 | ☐ |
| 8 | 동일한 수업 셀 클릭 | StudentModal 열림 | ☐ |
| 9 | 학생 목록 확인 | "테스트학생1" **표시 안 됨** | ☐ |

### 핵심 검증
> ⚠️ **CRITICAL**: 시뮬레이션에서 추가한 학생이 실시간 모드에서 보이면 **실패**

---

## 🧪 Test 3: 실제 반영 (15분)

### 목적
[실제 반영] 시 학생 데이터가 정상적으로 Live 컬렉션에 복사되는지 확인

### 단계

| # | 작업 | 예상 결과 | 통과 |
|---|------|----------|------|
| 1 | [시뮬레이션 모드] 토글 ON | 주황색 배경 | ☐ |
| 2 | 수업 셀 클릭 > 학생 추가: "반영테스트" | 저장 완료 | ☐ |
| 3 | [실제 반영] 버튼 클릭 | 확인 다이얼로그 표시 | ☐ |
| 4 | 확인 버튼 클릭 | "성공적으로 반영되었습니다" 알림 | ☐ |
| 5 | Firebase Console > `english_backups` 확인 | 새 백업 생성됨 | ☐ |
| 6 | 백업 문서에 `studentData` 필드 확인 | 필드 존재함 | ☐ |
| 7 | 시뮬레이션 모드 OFF (자동 전환) | 녹색 배경 | ☐ |
| 8 | 동일 수업 셀 > StudentModal | "반영테스트" 학생 **표시됨** | ☐ |
| 9 | Firebase Console > `수업목록` 확인 | "반영테스트" 존재 | ☐ |

### 핵심 검증
> ✅ 반영 후 실시간 모드에서 학생이 보여야 **성공**

---

## 🧪 Test 4: 백업 복원 (10분)

### 목적
백업 복원 시 학생 데이터도 함께 복원되는지 확인

### 단계

| # | 작업 | 예상 결과 | 통과 |
|---|------|----------|------|
| 1 | 실시간 모드에서 수업 셀 클릭 | StudentModal 열림 | ☐ |
| 2 | 학생 추가: "복원전학생" > 저장 | 저장 완료 | ☐ |
| 3 | [백업 기록] 버튼 클릭 | BackupHistoryModal 열림 | ☐ |
| 4 | Test 3에서 생성된 백업 선택 | 백업 정보 표시 | ☐ |
| 5 | [복원] 버튼 클릭 | 확인 다이얼로그 | ☐ |
| 6 | 확인 버튼 클릭 | "복원이 완료되었습니다" 알림 | ☐ |
| 7 | 알림에서 "학생 데이터" 섹션 확인 | 삭제/복원 개수 표시됨 | ☐ |
| 8 | 동일 수업 셀 > StudentModal | "복원전학생" **사라짐**, "반영테스트" **존재** | ☐ |

### 핵심 검증
> ✅ 백업 복원 후 학생 데이터도 백업 시점으로 돌아가야 **성공**

---

## 🧪 Test 5: 하위 호환성 (5분)

### 목적
`studentData` 필드가 없는 구 백업도 정상 복원되는지 확인

### 단계

| # | 작업 | 예상 결과 | 통과 |
|---|------|----------|------|
| 1 | [백업 기록] 모달 열기 | 목록 표시 | ☐ |
| 2 | 오래된 백업 선택 (studentData 없는 것) | 백업 정보 표시 | ☐ |
| 3 | [복원] 클릭 > 확인 | 복원 완료 알림 | ☐ |
| 4 | 알림 내용 확인 | "⚠️ 이 백업은 학생 데이터를 포함하지 않습니다" 표시 | ☐ |

### 핵심 검증
> ✅ 에러 없이 시간표만 복원되어야 **성공**

---

## 🔐 Test 6: 권한 테스트 (10분)

### 목적
Admin/Manager가 시뮬레이션 모드에서 읽기 전용인지 확인

### 6.1 Admin 계정 테스트

| # | 작업 | 예상 결과 | 통과 |
|---|------|----------|------|
| 1 | Admin 계정으로 로그인 | 로그인 성공 | ☐ |
| 2 | 영어 시간표 > 시뮬레이션 모드 ON | 주황색 배경 | ☐ |
| 3 | 수업 셀 클릭 > StudentModal | 모달 열림 | ☐ |
| 4 | 학생 추가 시도 | **입력 필드 비활성화** 또는 저장 버튼 비활성화 | ☐ |

### 6.2 Manager 계정 테스트

| # | 작업 | 예상 결과 | 통과 |
|---|------|----------|------|
| 1 | Manager 계정으로 로그인 | 로그인 성공 | ☐ |
| 2 | 동일한 테스트 수행 | **읽기 전용** 확인 | ☐ |

### 6.3 Firestore Rules 검증

| # | 작업 | 예상 결과 | 통과 |
|---|------|----------|------|
| 1 | Admin 계정으로 시뮬레이션 모드 진입 | 성공 | ☐ |
| 2 | 개발자 콘솔에서 직접 저장 시도 (해킹 시뮬레이션) | **permission-denied** 에러 | ☐ |

---

## 📊 테스트 결과 요약

| 테스트 | 상태 | 비고 |
|--------|------|------|
| Test 1: 시뮬레이션 진입 | ☐ Pass / ☐ Fail | |
| Test 2: 데이터 격리 | ☐ Pass / ☐ Fail | |
| Test 3: 실제 반영 | ☐ Pass / ☐ Fail | |
| Test 4: 백업 복원 | ☐ Pass / ☐ Fail | |
| Test 5: 하위 호환성 | ☐ Pass / ☐ Fail | |
| Test 6: 권한 테스트 | ☐ Pass / ☐ Fail | |

### 전체 결과

- [ ] **ALL PASS** - 프로덕션 배포 가능
- [ ] **일부 FAIL** - 수정 필요 (아래 기록)

### 실패 항목 기록

| 테스트 | 실패 단계 | 증상 | 예상 원인 |
|--------|----------|------|----------|
| | | | |
| | | | |

---

## 🛠️ 문제 발생 시 조치

### 증상: "permission-denied" 에러

**원인**: Firestore Security Rules 미배포
**해결**:
```bash
firebase deploy --only firestore:rules
```

### 증상: 학생 통계가 업데이트 안 됨

**원인**: useEffect 의존성 배열 누락
**해결**: EnglishClassTab.tsx Line 221 확인
```typescript
}, [scheduleData, isSimulationMode]);
```

### 증상: Draft 컬렉션이 생성되지 않음

**원인**: handleCopyLiveToDraft 오류
**해결**: 개발자 콘솔 에러 확인 후 보고

---

## 📝 테스트 완료 서명

- 테스트 일시: _________________
- 테스트 담당자: _________________
- 결과: ☐ PASS / ☐ FAIL
- 비고: 

---

**문서 끝**
