# ì¼ì • ê²€ìƒ‰ ê¸°ëŠ¥ êµ¬í˜„ ê³„íš

## ëª©í‘œ
ìº˜ë¦°ë” ì¼ì •ì„ ê²€ìƒ‰/í•„í„°ë§í•˜ëŠ” í†µí•© ê²€ìƒ‰ ê¸°ëŠ¥ êµ¬í˜„

---

## ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­

### 1. í…ìŠ¤íŠ¸ ê²€ìƒ‰
- ì¼ì •ëª…/ì„¤ëª…ì—ì„œ í‚¤ì›Œë“œ ê²€ìƒ‰
- ì‹¤ì‹œê°„ í•„í„°ë§ (ì…ë ¥ ì‹œ ì¦‰ì‹œ ë°˜ì˜)
- ê²€ìƒ‰ ê²°ê³¼ í•˜ì´ë¼ì´íŠ¸

### 2. ì¹´í…Œê³ ë¦¬ í•„í„°
- ìƒ‰ìƒ/ì¹´í…Œê³ ë¦¬ë³„ í•„í„°
- ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥
- í† ê¸€ ë°©ì‹ UI

### 3. ë‚ ì§œ ë²”ìœ„ ê²€ìƒ‰
- ì‹œì‘ì¼ ~ ì¢…ë£Œì¼ ì„ íƒ
- í•´ë‹¹ ê¸°ê°„ ì¼ì •ë§Œ í‘œì‹œ
- ë¹ ë¥¸ ì„ íƒ: ì˜¤ëŠ˜, ì´ë²ˆ ì£¼, ì´ë²ˆ ë‹¬

---

## UI ì„¤ê³„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” ì¼ì • ê²€ìƒ‰...                          [í•„í„°] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [í•„í„° íŒ¨ë„ - í¼ì¹¨ ì‹œ í‘œì‹œ]                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ì¹´í…Œê³ ë¦¬: [í•™êµ] [í•™ì›] [ì§„ë¡œ] [ê¸°íƒ€]        â”‚ â”‚
â”‚ â”‚ ê¸°ê°„: [ì´ë²ˆ ì£¼ â–¼] ë˜ëŠ” [2025.03.01] ~ [...] â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## êµ¬í˜„ ê³„íš (ìƒì„¸)

### êµ¬í˜„ ìœ„ì¹˜
- **íŒŒì¼**: `components/CalendarBoard.tsx`
- **ì‚½ì… ìœ„ì¹˜**: Line 310 (Navigation Group ìœ„)

---

### Phase 1: ë ˆì´ì•„ì›ƒ ì¬ë°°ì¹˜ & ì»´í¬ë„ŒíŠ¸ ì´ë™
- **ëª©í‘œ**: ê²€ìƒ‰ë°”ë¥¼ ìƒë‹¨ í—¤ë”ì˜ ë„¤ë¹„ê²Œì´ì…˜(ì¢Œ)ê³¼ ì•¡ì…˜ë²„íŠ¼(ìš°) ì‚¬ì´ë¡œ ì´ë™
- **êµ¬ì¡°**:
  ```tsx
  <div className="flex justify-between items-center gap-4 ...">
    <NavigationGroup /> {/* Left */}
    <SearchComponent className="flex-1 max-w-lg" /> {/* Center */}
    <ActionGroup /> {/* Right */}
  </div>
  ```

### Phase 2: í•„í„° ë¡œì§ ì „ë©´ ìˆ˜ì •
- **ì¹´í…Œê³ ë¦¬**:
  - ìƒ‰ìƒ í•„í„° ì œê±°
  - ì‹¤ì œ ë¶€ì„œ(Department) ëª…ì¹­ ê¸°ë°˜ ì„ íƒ UI
  - `departments` prop í™œìš©
- **ê¸°ê°„ í•„í„° (Smart Date Range)**:
  - **êµ¬ì„±ìš”ì†Œ**:
    1. ê¸°ì¤€ì¼ (Date Input)
    2. ê¸°ê°„ ë‹¨ìœ„ (1ì£¼/1ê°œì›”/1ë…„)
    3. ë°©í–¥ (ì´ì „/ì´í›„)
  - **ë¡œì§ ì˜ˆì‹œ**: 
    - 2025-01-25 + 1ë…„ + ì´ì „ => 2024-01-25 ~ 2025-01-25

### Phase 3: í…ŒìŠ¤íŠ¸
- ë‚ ì§œ ê³„ì‚° ë¡œì§ ê²€ì¦ (date-fns í™œìš©)
- ëª¨ë°”ì¼/ë°ìŠ¤í¬íƒ‘ ë ˆì´ì•„ì›ƒ í™•ì¸

---

### Phase 4: ê²°ê³¼ íŒ¨ë„ (Option B)
**ì˜ˆìƒ ì‹œê°„**: 45ë¶„

```tsx
{searchQuery && filteredEvents.length > 0 && (
  <div className="bg-white rounded-xl border shadow-lg max-h-[300px] overflow-y-auto">
    <div className="p-2 border-b font-bold">
      ê²€ìƒ‰ ê²°ê³¼ ({filteredEvents.length}ê±´)
    </div>
    {filteredEvents.map(event => (
      <div 
        key={event.id}
        onClick={() => {
          onDateChange(parseISO(event.startDate));
          setSearchQuery('');
        }}
        className="p-3 hover:bg-gray-50 cursor-pointer flex items-center gap-2"
      >
        <div className="w-3 h-3 rounded-full" style={{backgroundColor: event.color}} />
        <span className="font-bold">{event.title}</span>
        <span className="text-gray-400 text-sm">
          {format(parseISO(event.startDate), 'yyyy.MM.dd')}
        </span>
      </div>
    ))}
  </div>
)}
```

---

### Phase 5: í…ŒìŠ¤íŠ¸
- [ ] í…ìŠ¤íŠ¸ ê²€ìƒ‰ ë™ì‘ í™•ì¸
- [ ] ì¹´í…Œê³ ë¦¬ í•„í„° ë™ì‘ í™•ì¸
- [ ] ë‚ ì§œ ë²”ìœ„ í•„í„° ë™ì‘ í™•ì¸
- [ ] ê²°ê³¼ í´ë¦­ ì‹œ í•´ë‹¹ ë‚ ì§œë¡œ ì´ë™ í™•ì¸
- [ ] ëª¨ë°”ì¼ ë°˜ì‘í˜• í™•ì¸

---

## ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ (ì„ íƒë¨: ì˜µì…˜ B)

**ë³„ë„ ê²°ê³¼ íŒ¨ë„ ë°©ì‹**:
- ê²€ìƒ‰ë°” ì•„ë˜ ìŠ¬ë¼ì´ë“œ íŒ¨ë„ë¡œ ê²°ê³¼ í‘œì‹œ
- ë¦¬ìŠ¤íŠ¸ í˜•íƒœ: ì¼ì •ëª…, ë‚ ì§œ, ì¹´í…Œê³ ë¦¬
- í´ë¦­ ì‹œ í•´ë‹¹ ë‚ ì§œë¡œ ìº˜ë¦°ë” ì´ë™
- ê²°ê³¼ ê°œìˆ˜ í‘œì‹œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” "íšŒì˜" ê²€ìƒ‰                    [í•„í„° â–¼] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“‹ ê²€ìƒ‰ ê²°ê³¼ (3ê±´)                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ ğŸ”´ ì •ê¸°íšŒì˜ - 2025.03.05 (ìˆ˜)      â”‚   â”‚
â”‚ â”‚ ğŸŸ¡ í•™ë¶€ëª¨íšŒì˜ - 2025.03.12 (ìˆ˜)    â”‚   â”‚
â”‚ â”‚ ğŸ”µ êµì‚¬íšŒì˜ - 2025.03.20 (ëª©)      â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

---

## ì½”ë“œ ê²€ì¦ ë° ê°œì„ ì‚¬í•­ (2025-12-30)

### ì‹¤ì œ êµ¬í˜„ ì½”ë“œ ë¶„ì„ (CalendarBoard.tsx)

#### í˜„ì¬ êµ¬í˜„ ìƒíƒœ âœ…

**ìœ„ì¹˜**: Lines 247-303

**ìƒíƒœ ê´€ë¦¬**:
```typescript
const [searchQuery, setSearchQuery] = React.useState('');
const [isFilterOpen, setIsFilterOpen] = React.useState(false);
const [selectedDepts, setSelectedDepts] = React.useState<string[]>([]);
const [filterBaseDate, setFilterBaseDate] = React.useState<Date | null>(null);
const [filterDuration, setFilterDuration] = React.useState<'1w' | '1m' | '1y' | null>(null);
const [filterDirection, setFilterDirection] = React.useState<'before' | 'after'>('after');
```

**í•„í„°ë§ ë¡œì§** (useMemo ì‚¬ìš©):
```typescript
const filteredEvents = useMemo(() => {
    if (!searchQuery && selectedDepts.length === 0 && !filterBaseDate) {
        return []; // í™œì„± í•„í„°ê°€ ì—†ìœ¼ë©´ ë¹ˆ ë°°ì—´ ë°˜í™˜
    }

    // ë‚ ì§œ ë²”ìœ„ ê³„ì‚°
    let startRange: Date | null = null;
    let endRange: Date | null = null;

    if (filterBaseDate && filterDuration) {
        const base = startOfDay(filterBaseDate);
        if (filterDirection === 'after') {
            startRange = base;
            if (filterDuration === '1w') endRange = addWeeks(base, 1);
            else if (filterDuration === '1m') endRange = addMonths(base, 1);
            else if (filterDuration === '1y') endRange = addYears(base, 1);
        } else {
            endRange = base;
            if (filterDuration === '1w') startRange = subWeeks(base, 1);
            else if (filterDuration === '1m') startRange = subMonths(base, 1);
            else if (filterDuration === '1y') startRange = subYears(base, 1);
        }
    }

    return events.filter(e => {
        // 1. í…ìŠ¤íŠ¸ ê²€ìƒ‰
        const query = searchQuery.toLowerCase();
        const matchesText = !searchQuery ||
            e.title.toLowerCase().includes(query) ||
            (e.description && e.description.toLowerCase().includes(query)) ||
            (e.participants && typeof e.participants === 'string' &&
                e.participants.toLowerCase().includes(query));

        // 2. ë¶€ì„œ í•„í„°
        const matchesDept = selectedDepts.length === 0 ||
            selectedDepts.includes(e.departmentId);

        // 3. ë‚ ì§œ í•„í„°
        let matchesDate = true;
        if (startRange && endRange) {
            const eventStart = startOfDay(parseISO(e.startDate));
            matchesDate = eventStart >= startRange && eventStart <= endRange;
        }

        return matchesText && matchesDept && matchesDate;
    }).sort((a, b) => new Date(a.startDate).getTime() - new Date(b.startDate).getTime());
}, [events, searchQuery, selectedDepts, filterBaseDate, filterDuration, filterDirection]);
```

---

### Firebase ë¹„ìš© ë¶„ì„ ğŸ’°

#### ë¹„ìš© ì˜í–¥ í‰ê°€

**í˜„ì¬ êµ¬í˜„**:
- ê²€ìƒ‰ì€ **í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ**ì—ì„œ ìˆ˜í–‰ (Firestore ì¿¼ë¦¬ ì•„ë‹˜)
- `events` propìœ¼ë¡œ ì „ë‹¬ë°›ì€ ë°ì´í„°ë¥¼ JavaScriptë¡œ í•„í„°ë§
- **ì¶”ê°€ Firestore ì½ê¸° ì—†ìŒ** âœ…

**ë¹„ìš© ê³„ì‚°**:
```
ì½ê¸° ë¹„ìš©: +0íšŒ (ê²€ìƒ‰ì€ ë©”ëª¨ë¦¬ ë‚´ í•„í„°ë§)
ì“°ê¸° ë¹„ìš©: +0íšŒ (ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì €ì¥í•˜ì§€ ì•ŠìŒ)
ì´ ë¹„ìš© ì¦ê°€: $0.00/ì›” âœ…
```

**ê²°ë¡ **: ê²€ìƒ‰ ê¸°ëŠ¥ ì¶”ê°€ë¡œ ì¸í•œ **Firebase ë¹„ìš© ì¦ê°€ ì—†ìŒ**

#### ì„±ëŠ¥ ìµœì í™” ìƒíƒœ

**âœ… ì´ë¯¸ ì ìš©ëœ ìµœì í™”**:
1. **useMemo ì‚¬ìš©**: ì˜ì¡´ì„± ë°°ì—´ ë³€ê²½ ì‹œì—ë§Œ ì¬ê³„ì‚°
2. **ì¡°ê±´ë¶€ í•„í„°ë§**: í™œì„± í•„í„°ê°€ ì—†ìœ¼ë©´ ë¹ˆ ë°°ì—´ ë°˜í™˜ (ë¶ˆí•„ìš”í•œ ê³„ì‚° ë°©ì§€)
3. **ì •ë ¬**: ë‚ ì§œìˆœ ì •ë ¬ë¡œ ì‚¬ìš©ì ê²½í—˜ í–¥ìƒ

**âš ï¸ ì ì¬ì  ì„±ëŠ¥ ì´ìŠˆ**:

**ì´ìŠˆ 1: ëŒ€ëŸ‰ ë°ì´í„° ì²˜ë¦¬**
```typescript
// ë¬¸ì œ: eventsê°€ 10,000ê°œ ì´ìƒì¼ ë•Œ í•„í„°ë§ ì§€ì—° ë°œìƒ ê°€ëŠ¥
return events.filter(e => { ... }).sort(...);

// í˜„ì¬ ìƒí™©: í•™ì› ê´€ë¦¬ ì‹œìŠ¤í…œ - ì—°ê°„ ì´ë²¤íŠ¸ ~1,000ê°œ ì˜ˆìƒ
// ì˜í–¥ë„: ë‚®ìŒ (í˜„ì¬ ë°ì´í„° ê·œëª¨ì—ì„œëŠ” ë¬¸ì œ ì—†ìŒ)
```

**ì´ìŠˆ 2: ê²€ìƒ‰ì–´ ì…ë ¥ë§ˆë‹¤ ì¬ê³„ì‚°**
```typescript
// í˜„ì¬: ì…ë ¥í•  ë•Œë§ˆë‹¤ useMemo ì¬ì‹¤í–‰
onChange={(e) => setSearchQuery(e.target.value)}

// ê°œì„ : Debounce ì¶”ê°€ (300ms)
const debouncedSearch = useMemo(
    () => debounce((value: string) => setSearchQuery(value), 300),
    []
);

onChange={(e) => debouncedSearch(e.target.value)}
```

**ì˜ˆìƒ íš¨ê³¼**: íƒ€ì´í•‘ ì‹œ ë¶ˆí•„ìš”í•œ ì¬ê³„ì‚° ë°©ì§€ (ì„±ëŠ¥ í–¥ìƒ)

---

### ì½”ë“œ í’ˆì§ˆ ê²€í†  ğŸ”

#### âœ… ìš°ìˆ˜í•œ ì 

**1. íƒ€ì… ì•ˆì „ì„±**
```typescript
// âœ… íƒ€ì… ê°€ë“œ ì ìš©
(e.participants && typeof e.participants === 'string' &&
    e.participants.toLowerCase().includes(query))
```

**2. ì•ˆì „í•œ Optional Chaining**
```typescript
// âœ… null/undefined ì²˜ë¦¬
(e.description && e.description.toLowerCase().includes(query))
```

**3. ì˜ì¡´ì„± ë°°ì—´ ëª…ì‹œ**
```typescript
// âœ… ëª¨ë“  ì˜ì¡´ì„± ë‚˜ì—´
}, [events, searchQuery, selectedDepts, filterBaseDate, filterDuration, filterDirection]);
```

#### âš ï¸ ê°œì„  í•„ìš” ì‚¬í•­

**1. participants í•„ë“œ íƒ€ì… ë¶ˆì¼ì¹˜**

**ë¬¸ì œ**:
```typescript
// CalendarEvent íƒ€ì… ì •ì˜ í™•ì¸ í•„ìš”
// participantsê°€ string | string[] | undefined ì¼ ìˆ˜ ìˆìŒ
e.participants && typeof e.participants === 'string'
```

**ê°œì„ ì•ˆ**:
```typescript
// ë°°ì—´ë„ ì²˜ë¦¬ ê°€ëŠ¥í•˜ë„ë¡ ê°œì„ 
const matchesParticipants = () => {
    if (!e.participants) return false;

    if (typeof e.participants === 'string') {
        return e.participants.toLowerCase().includes(query);
    }

    if (Array.isArray(e.participants)) {
        return e.participants.some(p =>
            p.toLowerCase().includes(query)
        );
    }

    return false;
};

const matchesText = !searchQuery ||
    e.title.toLowerCase().includes(query) ||
    (e.description && e.description.toLowerCase().includes(query)) ||
    matchesParticipants();
```

**2. ë‚ ì§œ ë²”ìœ„ ê³„ì‚° ì¤‘ë³µ ì½”ë“œ**

**ë¬¸ì œ**:
```typescript
// before/after ë¶„ê¸°ì—ì„œ ì¤‘ë³µ íŒ¨í„´
if (filterDuration === '1w') endRange = addWeeks(base, 1);
else if (filterDuration === '1m') endRange = addMonths(base, 1);
else if (filterDuration === '1y') endRange = addYears(base, 1);
```

**ê°œì„ ì•ˆ**:
```typescript
const calculateDateRange = (base: Date, duration: '1w' | '1m' | '1y', direction: 'before' | 'after') => {
    const durationMap = {
        '1w': { add: addWeeks, sub: subWeeks },
        '1m': { add: addMonths, sub: subMonths },
        '1y': { add: addYears, sub: subYears }
    };

    const fn = direction === 'after'
        ? durationMap[duration].add
        : durationMap[duration].sub;

    return direction === 'after'
        ? { start: base, end: fn(base, 1) }
        : { start: fn(base, 1), end: base };
};

if (filterBaseDate && filterDuration) {
    const base = startOfDay(filterBaseDate);
    const range = calculateDateRange(base, filterDuration, filterDirection);
    startRange = range.start;
    endRange = range.end;
}
```

**3. ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ ìƒíƒœ ì²˜ë¦¬**

**í˜„ì¬** (Lines 595-600):
```typescript
{(filteredEvents.length === 0) && (searchQuery) && (
    <div className="...">
        <p>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
    </div>
)}
```

**ë¬¸ì œ**: selectedDeptsë‚˜ filterBaseDateë¡œë§Œ í•„í„°ë§ ì‹œ ë©”ì‹œì§€ ë¯¸í‘œì‹œ

**ê°œì„ ì•ˆ**:
```typescript
const hasActiveFilters = searchQuery || selectedDepts.length > 0 || filterBaseDate;

{(filteredEvents.length === 0) && hasActiveFilters && (
    <div className="...">
        <p>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
        <p className="text-xs">í˜„ì¬ í•„í„°:
            {searchQuery && `ê²€ìƒ‰ì–´ "${searchQuery}"`}
            {selectedDepts.length > 0 && ` | ë¶€ì„œ ${selectedDepts.length}ê°œ`}
            {filterBaseDate && ` | ê¸°ê°„ ${format(filterBaseDate, 'yyyy.MM.dd')}`}
        </p>
    </div>
)}
```

---

### ì ì¬ì  ë²„ê·¸ ë° ì—£ì§€ ì¼€ì´ìŠ¤ ğŸ›

#### ë²„ê·¸ 1: ë‚ ì§œ ê²½ê³„ê°’ ì²˜ë¦¬

**ì‹œë‚˜ë¦¬ì˜¤**:
```
ê¸°ì¤€ì¼: 2025-02-28
ê¸°ê°„: 1ê°œì›” í›„
ê²°ê³¼: 2025-03-28 (ì˜ˆìƒ) vs 2025-03-31 (ì‹¤ì œ?)
```

**í™•ì¸ í•„ìš”**:
```typescript
// date-fnsì˜ addMonths ë™ì‘ í™•ì¸
console.log(addMonths(new Date('2025-01-31'), 1));
// 2025-02-28 (ì›”ë§ ì¡°ì •)
```

**ëŒ€ì‘**: date-fnsëŠ” ìë™ìœ¼ë¡œ ì›”ë§ ì¡°ì •í•˜ë¯€ë¡œ **ë¬¸ì œ ì—†ìŒ** âœ…

#### ë²„ê·¸ 2: ìœ¤ë…„ ì²˜ë¦¬

**ì‹œë‚˜ë¦¬ì˜¤**:
```
ê¸°ì¤€ì¼: 2024-02-29 (ìœ¤ë…„)
ê¸°ê°„: 1ë…„ í›„
ê²°ê³¼: 2025-02-28? 2025-03-01?
```

**í™•ì¸**:
```typescript
console.log(addYears(new Date('2024-02-29'), 1));
// 2025-02-28 (date-fnsê°€ ìë™ ì¡°ì •)
```

**ëŒ€ì‘**: date-fnsê°€ ì²˜ë¦¬í•˜ë¯€ë¡œ **ë¬¸ì œ ì—†ìŒ** âœ…

#### ë²„ê·¸ 3: íŠ¹ìˆ˜ë¬¸ì ì…ë ¥

**ì‹œë‚˜ë¦¬ì˜¤**:
```
ê²€ìƒ‰ì–´: "íšŒì˜[ì •ê¸°]"
ì—ëŸ¬: ì •ê·œì‹ìœ¼ë¡œ í•´ì„ë  ìˆ˜ ìˆìŒ? (í˜„ì¬ëŠ” ë‹¨ìˆœ includes ì‚¬ìš©)
```

**í™•ì¸**: `includes()` ë©”ì„œë“œëŠ” ë¬¸ìì—´ë¡œë§Œ ì²˜ë¦¬í•˜ë¯€ë¡œ **ë¬¸ì œ ì—†ìŒ** âœ…

#### ë²„ê·¸ 4: ëŒ€ì†Œë¬¸ì êµ¬ë¶„ (ë¹„ì˜ì–´ê¶Œ)

**ì‹œë‚˜ë¦¬ì˜¤**:
```
ê²€ìƒ‰ì–´: "Ä°stanbul" (í„°í‚¤ì–´ ëŒ€ë¬¸ì I)
ê²°ê³¼: "istanbul"ê³¼ ë§¤ì¹­ë˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒ
```

**í˜„ì¬ ì½”ë“œ**:
```typescript
toLowerCase() // JavaScriptì˜ ê¸°ë³¸ ë™ì‘ ì‚¬ìš©
```

**ì˜í–¥**: í•œêµ­ì–´ ì„œë¹„ìŠ¤ì´ë¯€ë¡œ **ì˜í–¥ ì—†ìŒ** âœ…

#### ë²„ê·¸ 5: ë©”ëª¨ë¦¬ ëˆ„ìˆ˜

**í™•ì¸ í•„ìš”**:
```typescript
// ê²€ìƒ‰ íŒ¨ë„ ì—´ë¦¼/ë‹«í˜ ì‹œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ê´€ë¦¬
// CalendarBoard ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ cleanup
```

**í˜„ì¬ ìƒíƒœ**: ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë¯¸ì‚¬ìš© (ìƒíƒœë§Œ ì‚¬ìš©) â†’ **ë¬¸ì œ ì—†ìŒ** âœ…

---

### ë³´ì•ˆ ê²€í†  ğŸ”’

#### âœ… ì•ˆì „í•¨

1. **XSS ë°©ì§€**: Reactê°€ ìë™ìœ¼ë¡œ ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬
2. **ì¸ì ì…˜ ê³µê²©**: Firestore ì¿¼ë¦¬ ë¯¸ì‚¬ìš© (í´ë¼ì´ì–¸íŠ¸ í•„í„°ë§)
3. **ë¯¼ê° ì •ë³´ ë…¸ì¶œ**: ê²€ìƒ‰ ê²°ê³¼ëŠ” ì´ë¯¸ ë¡œë“œëœ ë°ì´í„°ë§Œ í‘œì‹œ

#### âš ï¸ í™•ì¸ í•„ìš”

**Firestore Security Rules**:
```javascript
// events ì»¬ë ‰ì…˜ ì½ê¸° ê¶Œí•œ í™•ì¸
match /events/{eventId} {
  allow read: if request.auth != null; // ì¸ì¦ëœ ì‚¬ìš©ìë§Œ?
}
```

**ê¶Œì¥**: ë¶€ì„œë³„ ì ‘ê·¼ ì œì–´ í•„ìš” ì‹œ ì¶”ê°€ ê·œì¹™ ì„¤ì •

---

## 4. ìµœì¢… êµ¬í˜„ ë³´ê³ ì„œ (2025-12-30 ì™„ë£Œ)

### 4.1 UI êµ¬ì¡° ë° ë ˆì´ì•„ì›ƒ
- **ìœ„ì¹˜ ë³€ê²½**: ê²€ìƒ‰ë°”ë¥¼ í—¤ë”ì˜ ì¤‘ì•™(Navigation Groupê³¼ Action Group ì‚¬ì´)ì— ë°°ì¹˜í•˜ì—¬ ì ‘ê·¼ì„± í–¥ìƒ.
- **ë°˜ì‘í˜• ë””ìì¸**: `flex-1` ë° `max-w` ì†ì„±ì„ ì‚¬ìš©í•˜ì—¬ í™”ë©´ ë„ˆë¹„ì— ë”°ë¼ ìœ ë™ì ìœ¼ë¡œ ì¡°ì ˆë¨.
- **ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°**:
  ```tsx
  <div className="flex ... gap-4">
    <NavigationGroup /> {/* ë‚ ì§œ ì´ë™ */}
    <div className="flex-1 ...">
      <SearchBar /> {/* ê²€ìƒ‰ ì…ë ¥ ë° í•„í„° ë²„íŠ¼ */}
      <FilterPanel /> {/* ì¡°ê±´ë¶€ ë Œë”ë§ */}
      <ResultList /> {/* ì¡°ê±´ë¶€ ë Œë”ë§ */}
    </div>
    <ActionGroup /> {/* ë‚´ ì¼ì •, ë³´ê¸° ì„¤ì • ë“± */}
  </div>
  ```

### 4.2 í•„í„° ë¡œì§ (Smart Filter)
ê¸°ì¡´ ê³„íš(ë‹¨ìˆœ ë‚ ì§œ ë²”ìœ„)ì—ì„œ ì‚¬ìš©ì í”¼ë“œë°±ì„ ë°˜ì˜í•˜ì—¬ **ìŠ¤ë§ˆíŠ¸ ê¸°ê°„ í•„í„°**ë¡œ ê³ ë„í™”ë˜ì—ˆìŠµë‹ˆë‹¤.

1.  **í…ìŠ¤íŠ¸ ê²€ìƒ‰**:
    - ëŒ€ìƒ: ì œëª©, ì„¤ëª…, ì°¸ì—¬ì(`participants`)
    - ë°©ì‹: `toLowerCase()`ë¥¼ ì´ìš©í•œ ëŒ€ì†Œë¬¸ì ë¬´ì‹œ ë¶€ë¶„ ì¼ì¹˜ ê²€ìƒ‰
    - **ì•ˆì „ì„± í™•ë³´**: `participants` í•„ë“œê°€ ë¬¸ìì—´ì´ ì•„ë‹Œ ê²½ìš°ë¥¼ ëŒ€ë¹„í•œ íƒ€ì… ê°€ë“œ(`typeof === 'string'`) ì¶”ê°€ ì ìš©.

2.  **ì¹´í…Œê³ ë¦¬ í•„í„°**:
    - ê¸°ì¤€: `departmentId` (ë¶€ì„œ ID)
    - UI: `departments` ë°°ì—´ì„ ê¸°ë°˜ìœ¼ë¡œ ë²„íŠ¼ ìƒì„± (ê¸°ì¡´ ìƒ‰ìƒ í•„í„° ëŒ€ì²´)
    - ë™ì‘: ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥ (OR ì¡°ê±´)

3.  **ê¸°ê°„ í•„í„° (Smart Date Range)**:
    - **êµ¬ì„±ìš”ì†Œ**:
        - ê¸°ì¤€ì¼ (`filterBaseDate`): ì‚¬ìš©ì ì§€ì • ë‚ ì§œ
        - ê¸°ê°„ (`filterDuration`): 1ì£¼(1w) / 1ê°œì›”(1m) / 1ë…„(1y)
        - ë°©í–¥ (`filterDirection`): ì´ì „(before) / ì´í›„(after)
    - **ê³„ì‚° ë¡œì§**:
        - `date-fns`ì˜ `addWeeks`, `subMonths` ë“±ì„ í™œìš©í•˜ì—¬ ë™ì ìœ¼ë¡œ `startRange`ì™€ `endRange` ê³„ì‚°.
        - ì˜ˆ: [2025-01-01] + [1ë…„] + [ì´ì „] => 2024-01-01 ~ 2025-01-01

### 4.3 ë°ì´í„° ì²˜ë¦¬ ë° ì„±ëŠ¥
- **Memoization**: `useMemo` í›…ì„ ì‚¬ìš©í•˜ì—¬ í•„í„° ì¡°ê±´ì´ë‚˜ ì›ë³¸ ì´ë²¤íŠ¸ ë°ì´í„°ê°€ ë³€ê²½ë  ë•Œë§Œ í•„í„°ë§ ë¡œì§ ì¬ìˆ˜í–‰.
- **ë‚ ì§œ í¬ë§·**: `date-fns/locale/ko`ë¥¼ ì ìš©í•˜ì—¬ í•œêµ­ì–´ ìš”ì¼ ë° ë‚ ì§œ í˜•ì‹ìœ¼ë¡œ ê²°ê³¼ í‘œì‹œ.

### 4.4 ì£¼ìš” ìˆ˜ì • ì´ë ¥
- **ë²„ê·¸ ìˆ˜ì •**: `e.participants.toLowerCase` ì‹¤í–‰ ì‹œ ë°œìƒí•˜ë˜ `TypeError` ìˆ˜ì • (ë°ì´í„° ë¬´ê²°ì„± í™•ë³´).
- **UI ê°œì„ **: ê²€ìƒ‰ë°”ê°€ ë„ˆë¬´ ê¸¸ë‹¤ëŠ” í”¼ë“œë°± ë°˜ì˜, ë ˆì´ì•„ì›ƒ ì¤‘ì•™ ë°°ì¹˜ë¡œ ìˆ˜ì •.

---

## 5. ê¶Œì¥ ê°œì„ ì‚¬í•­ (ìš°ì„ ìˆœìœ„ë³„)

### ğŸ”´ High Priority (ì¦‰ì‹œ ì ìš© ê¶Œì¥)

#### 1. Debounce ì¶”ê°€ë¡œ ì„±ëŠ¥ ìµœì í™”
**ì˜ˆìƒ ì†Œìš”**: 15ë¶„
**íŒŒì¼**: CalendarBoard.tsx
**ìœ„ì¹˜**: Line 437

**í˜„ì¬**:
```typescript
onChange={(e) => setSearchQuery(e.target.value)}
```

**ê°œì„ **:
```typescript
import { debounce } from 'lodash';

// ì»´í¬ë„ŒíŠ¸ ìƒë‹¨
const debouncedSetSearch = useMemo(
    () => debounce((value: string) => setSearchQuery(value), 300),
    []
);

// cleanup
useEffect(() => {
    return () => {
        debouncedSetSearch.cancel();
    };
}, [debouncedSetSearch]);

// input onChange
onChange={(e) => debouncedSetSearch(e.target.value)}
```

**íš¨ê³¼**: íƒ€ì´í•‘ ì‹œ ë¶ˆí•„ìš”í•œ ì¬ê³„ì‚° ë°©ì§€, CPU ì‚¬ìš©ëŸ‰ ê°ì†Œ

---

#### 2. ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ ì¡°ê±´ ê°œì„ 
**ì˜ˆìƒ ì†Œìš”**: 10ë¶„
**íŒŒì¼**: CalendarBoard.tsx
**ìœ„ì¹˜**: Line 595

**í˜„ì¬**:
```typescript
{(filteredEvents.length === 0) && (searchQuery) && (
    // ë©”ì‹œì§€ í‘œì‹œ
)}
```

**ê°œì„ **:
```typescript
const hasActiveFilters = searchQuery || selectedDepts.length > 0 || filterBaseDate;

{(filteredEvents.length === 0) && hasActiveFilters && (
    <div className="...">
        <Search size={32} className="mx-auto text-gray-300 mb-2" />
        <p className="text-gray-500 font-bold text-sm">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
        <div className="text-xs text-gray-400 mt-2 space-y-1">
            {searchQuery && <p>ê²€ìƒ‰ì–´: "{searchQuery}"</p>}
            {selectedDepts.length > 0 && (
                <p>ì„ íƒëœ ë¶€ì„œ: {selectedDepts.length}ê°œ</p>
            )}
            {filterBaseDate && (
                <p>ê¸°ê°„: {format(filterBaseDate, 'yyyy.MM.dd')} {filterDuration && `(${filterDuration} ${filterDirection === 'after' ? 'ì´í›„' : 'ì´ì „'})`}</p>
            )}
        </div>
        <button
            onClick={() => {
                setSearchQuery('');
                setSelectedDepts([]);
                setFilterBaseDate(null);
                setFilterDuration(null);
            }}
            className="mt-3 text-xs text-indigo-500 hover:underline"
        >
            ëª¨ë“  í•„í„° ì´ˆê¸°í™”
        </button>
    </div>
)}
```

**íš¨ê³¼**: ì‚¬ìš©ìê°€ ì™œ ê²°ê³¼ê°€ ì—†ëŠ”ì§€ ëª…í™•íˆ ì´í•´, UX í–¥ìƒ

---

### ğŸŸ¡ Medium Priority (ë‹¤ìŒ ìŠ¤í”„ë¦°íŠ¸)

#### 3. participants ë°°ì—´ íƒ€ì… ì§€ì›
**ì˜ˆìƒ ì†Œìš”**: 30ë¶„
**íŒŒì¼**: CalendarBoard.tsx
**ìœ„ì¹˜**: Line 285-288

**ê°œì„ **:
```typescript
const matchesParticipants = () => {
    if (!e.participants) return false;

    if (typeof e.participants === 'string') {
        return e.participants.toLowerCase().includes(query);
    }

    if (Array.isArray(e.participants)) {
        return e.participants.some(p =>
            typeof p === 'string' && p.toLowerCase().includes(query)
        );
    }

    return false;
};

const matchesText = !searchQuery ||
    e.title.toLowerCase().includes(query) ||
    (e.description && e.description.toLowerCase().includes(query)) ||
    matchesParticipants();
```

**íš¨ê³¼**: í–¥í›„ ì°¸ì—¬ì í•„ë“œê°€ ë°°ì—´ë¡œ ë³€ê²½ë˜ì–´ë„ í˜¸í™˜ì„± ìœ ì§€

---

#### 4. ë‚ ì§œ ë²”ìœ„ ê³„ì‚° í•¨ìˆ˜ ë¦¬íŒ©í† ë§
**ì˜ˆìƒ ì†Œìš”**: 45ë¶„
**íŒŒì¼**: CalendarBoard.tsx
**ìœ„ì¹˜**: Line 267-280

**ê°œì„ **: ë³„ë„ ìœ í‹¸ í•¨ìˆ˜ ë¶„ë¦¬
```typescript
// utils/dateRangeUtils.ts (ì‹ ê·œ íŒŒì¼)
export const calculateDateRange = (
    base: Date,
    duration: '1w' | '1m' | '1y',
    direction: 'before' | 'after'
): { start: Date; end: Date } => {
    const durationMap = {
        '1w': { add: addWeeks, sub: subWeeks },
        '1m': { add: addMonths, sub: subMonths },
        '1y': { add: addYears, sub: subYears }
    };

    const fn = direction === 'after'
        ? durationMap[duration].add
        : durationMap[duration].sub;

    return direction === 'after'
        ? { start: base, end: fn(base, 1) }
        : { start: fn(base, 1), end: base };
};

// CalendarBoard.tsxì—ì„œ ì‚¬ìš©
if (filterBaseDate && filterDuration) {
    const base = startOfDay(filterBaseDate);
    const range = calculateDateRange(base, filterDuration, filterDirection);
    startRange = range.start;
    endRange = range.end;
}
```

**íš¨ê³¼**: ì½”ë“œ ì¬ì‚¬ìš©ì„± í–¥ìƒ, í…ŒìŠ¤íŠ¸ ìš©ì´

---

### ğŸŸ¢ Low Priority (ì„ íƒì )

#### 5. ê²€ìƒ‰ íˆìŠ¤í† ë¦¬ ê¸°ëŠ¥
**ì˜ˆìƒ ì†Œìš”**: 2ì‹œê°„
**ì„¤ëª…**: ìµœê·¼ ê²€ìƒ‰ì–´ 5ê°œ ì €ì¥ ë° ì œì•ˆ

```typescript
const [searchHistory, setSearchHistory] = useState<string[]>([]);

// ê²€ìƒ‰ ì‹œ íˆìŠ¤í† ë¦¬ì— ì¶”ê°€
const addToHistory = (query: string) => {
    if (!query.trim()) return;
    const newHistory = [query, ...searchHistory.filter(h => h !== query)].slice(0, 5);
    setSearchHistory(newHistory);
    localStorage.setItem('search_history', JSON.stringify(newHistory));
};

// ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸ ì‹œ ë¡œë“œ
useEffect(() => {
    const saved = localStorage.getItem('search_history');
    if (saved) {
        setSearchHistory(JSON.parse(saved));
    }
}, []);
```

---

#### 6. ê²€ìƒ‰ ê²°ê³¼ í•˜ì´ë¼ì´íŠ¸
**ì˜ˆìƒ ì†Œìš”**: 1ì‹œê°„
**ì„¤ëª…**: ê²€ìƒ‰ì–´ì™€ ë§¤ì¹­ë˜ëŠ” ë¶€ë¶„ ê°•ì¡° í‘œì‹œ

```typescript
const highlightText = (text: string, query: string) => {
    if (!query) return text;
    const parts = text.split(new RegExp(`(${query})`, 'gi'));
    return parts.map((part, i) =>
        part.toLowerCase() === query.toLowerCase() ?
            <mark key={i} className="bg-yellow-200">{part}</mark> :
            part
    );
};

// ì‚¬ìš©
<span className="font-bold">{highlightText(event.title, searchQuery)}</span>
```

---

#### 7. ê³ ê¸‰ ê²€ìƒ‰ ì˜µì…˜
**ì˜ˆìƒ ì†Œìš”**: 3ì‹œê°„
**ì„¤ëª…**: AND/OR/NOT ì—°ì‚°ì ì§€ì›

```typescript
// ì˜ˆ: "íšŒì˜ AND ì •ê¸°" ë˜ëŠ” "í–‰ì‚¬ NOT ì·¨ì†Œ"
const parseSearchQuery = (query: string) => {
    // ê°„ë‹¨í•œ êµ¬í˜„
    const terms = query.split(' AND ').map(t => t.trim());
    // ... ë” ë³µì¡í•œ íŒŒì‹± ë¡œì§
};
```

---

## 6. í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
- [ ] í…ìŠ¤íŠ¸ ê²€ìƒ‰ (ì œëª©, ì„¤ëª…, ì°¸ì—¬ì)
- [ ] ë¶€ì„œ í•„í„° (ë‹¨ì¼/ë‹¤ì¤‘ ì„ íƒ)
- [ ] ë‚ ì§œ ë²”ìœ„ ê³„ì‚° (1ì£¼/1ê°œì›”/1ë…„, ì´ì „/ì´í›„)
- [ ] ë¹ˆ ê²€ìƒ‰ì–´ ì²˜ë¦¬
- [ ] íŠ¹ìˆ˜ë¬¸ì ê²€ìƒ‰
- [ ] participants íƒ€ì… ê°€ë“œ

### í†µí•© í…ŒìŠ¤íŠ¸
- [ ] ê²€ìƒ‰ + ë¶€ì„œ í•„í„° ì¡°í•©
- [ ] ê²€ìƒ‰ + ë‚ ì§œ í•„í„° ì¡°í•©
- [ ] ëª¨ë“  í•„í„° ë™ì‹œ ì ìš©
- [ ] í•„í„° ì´ˆê¸°í™”

### E2E í…ŒìŠ¤íŠ¸
- [ ] ê²€ìƒ‰ì–´ ì…ë ¥ â†’ ì‹¤ì‹œê°„ í•„í„°ë§
- [ ] ê²€ìƒ‰ ê²°ê³¼ í´ë¦­ â†’ í•´ë‹¹ ë‚ ì§œë¡œ ì´ë™
- [ ] í•„í„° íŒ¨ë„ ì—´ê¸°/ë‹«ê¸°
- [ ] ëª¨ë°”ì¼ í™”ë©´ì—ì„œ ê²€ìƒ‰

### ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
- [ ] 1,000ê°œ ì´ë²¤íŠ¸ í•„í„°ë§ (<100ms)
- [ ] 10,000ê°œ ì´ë²¤íŠ¸ í•„í„°ë§ (<500ms)
- [ ] íƒ€ì´í•‘ ì‹œ ì§€ì—° ì—†ìŒ (debounce ì ìš© í›„)

### ì ‘ê·¼ì„± í…ŒìŠ¤íŠ¸
- [ ] í‚¤ë³´ë“œë¡œ ê²€ìƒ‰ ê°€ëŠ¥
- [ ] Tab í‚¤ë¡œ í•„í„° ì´ë™
- [ ] Enter í‚¤ë¡œ ê²€ìƒ‰ ê²°ê³¼ ì„ íƒ
- [ ] ìŠ¤í¬ë¦° ë¦¬ë” í˜¸í™˜ì„±

---

## 7. ë³€ê²½ ì´ë ¥

### v2.0.0 (2025-12-30 - ì½”ë“œ ê²€ì¦ ë° ê°œì„ ì•ˆ ì¶”ê°€)
- [ì¶”ê°€] **ì½”ë“œ ê²€ì¦ ì„¹ì…˜**: ì‹¤ì œ êµ¬í˜„ ì½”ë“œ ë¶„ì„ (Lines 247-303)
- [ì¶”ê°€] **Firebase ë¹„ìš© ë¶„ì„**: ë¹„ìš© ì¦ê°€ ì—†ìŒ í™•ì¸ ($0.00/ì›”)
- [ì¶”ê°€] **ì„±ëŠ¥ ìµœì í™” ìƒíƒœ**: useMemo, ì¡°ê±´ë¶€ í•„í„°ë§, ì •ë ¬
- [ì¶”ê°€] **ì½”ë“œ í’ˆì§ˆ ê²€í† **: ìš°ìˆ˜í•œ ì  3ê°œ, ê°œì„ ì‚¬í•­ 3ê°œ
- [ì¶”ê°€] **ì ì¬ì  ë²„ê·¸ ë¶„ì„**: 5ê°€ì§€ ì—£ì§€ ì¼€ì´ìŠ¤ ê²€ì¦
- [ì¶”ê°€] **ë³´ì•ˆ ê²€í† **: XSS ë°©ì§€, ì¸ì ì…˜ ê³µê²© ëŒ€ì‘
- [ì¶”ê°€] **ê¶Œì¥ ê°œì„ ì‚¬í•­**: ìš°ì„ ìˆœìœ„ë³„ 7ê°€ì§€ ì œì•ˆ
  - High: Debounce ì¶”ê°€, ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ ì¡°ê±´ ê°œì„ 
  - Medium: participants ë°°ì—´ ì§€ì›, ë‚ ì§œ ê³„ì‚° ë¦¬íŒ©í† ë§
  - Low: ê²€ìƒ‰ íˆìŠ¤í† ë¦¬, í•˜ì´ë¼ì´íŠ¸, ê³ ê¸‰ ê²€ìƒ‰
- [ì¶”ê°€] **í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸**: ë‹¨ìœ„/í†µí•©/E2E/ì„±ëŠ¥/ì ‘ê·¼ì„±

### v1.0.0 (2025-12-29)
- [ìµœì´ˆ] ë¬¸ì„œ ì‘ì„± (ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­, UI ì„¤ê³„, êµ¬í˜„ ê³„íš)
