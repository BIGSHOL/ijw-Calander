# 팀장 역할 시스템 문서 검증 보고서
## team_leader_roles.md 점검

> 작성일: 2026-01-02
> 점검 대상: team_leader_roles.md (v1.0)
> 검증 방법: 문서-코드 일치성 검증

---

## 📊 실행 요약

### 전체 평가
- **문서 정확도**: 100% (완벽 일치)
- **코드 구현 일치도**: 100% (완벽 일치)
- **문서 완성도**: 60% (상세 설명 부족)
- **전체 등급**: B+ (양호, 상세화 필요)

### 결론
✅ **문서가 코드와 완벽히 일치하나 상세 설명 추가 필요**

---

## 📋 목차

1. [문서-코드 일치성 검증](#1-문서-코드-일치성-검증)
2. [누락된 내용](#2-누락된-내용)
3. [업데이트 권장 사항](#3-업데이트-권장-사항)
4. [긍정적 평가](#4-긍정적-평가)
5. [최종 권장사항](#5-최종-권장사항)

---

## 1. 문서-코드 일치성 검증

### 1.1. UserRole 타입 정의 ✅ **100% 일치**

**문서 내용** (Line 10):
```
수학팀장(math_lead)과 영어팀장(english_lead) 역할을 추가
```

**실제 구현** ([types.ts:73](../../types.ts#L73)):
```typescript
export type UserRole = 'master' | 'admin' | 'manager' | 'editor' | 'math_lead' | 'english_lead' | 'user' | 'viewer' | 'guest';
```

**평가**: ✅ **완벽 일치**

---

### 1.2. 역할 계층 구조 ✅ **100% 일치**

**문서 내용** (Line 14-16):
```
MASTER → ADMIN → MANAGER → EDITOR → 수학팀장 → 영어팀장 → USER → VIEWER → GUEST
```

**실제 구현** ([types.ts:75](../../types.ts#L75)):
```typescript
export const ROLE_HIERARCHY: UserRole[] = ['master', 'admin', 'manager', 'editor', 'math_lead', 'english_lead', 'user', 'viewer', 'guest'];
```

**평가**: ✅ **완벽 일치**

---

### 1.3. 역할 레이블 ✅ **100% 일치**

**문서 내용** (Line 36):
```
ROLE_LABELS에 한글 레이블 추가 ('수학팀장', '영어팀장')
```

**실제 구현** ([types.ts:77-87](../../types.ts#L77-L87)):
```typescript
export const ROLE_LABELS: Record<UserRole, string> = {
  master: 'MASTER',
  admin: 'ADMIN',
  manager: 'MANAGER',
  editor: 'EDITOR',
  math_lead: '수학팀장',        // ✅
  english_lead: '영어팀장',     // ✅
  user: 'USER',
  viewer: 'VIEWER',
  guest: 'GUEST'
};
```

**평가**: ✅ **완벽 일치**

---

### 1.4. 권한 비교표 ✅ **100% 일치**

**문서 내용** (Line 20-28):

| 권한 | 수학팀장 | 영어팀장 |
|------|:-------:|:-------:|
| 수학 시간표 보기 | ✅ | ✅ |
| 수학 시간표 편집 | ✅ | ❌ |
| 영어 시간표 보기 | ✅ | ✅ |
| 영어 시간표 편집 | ❌ | ✅ |
| 수업 목록 보기/편집 | ✅ | ✅ |
| 일정 생성/수정(본인) | ✅ | ✅ |
| 출석 관리 | ✅ | ✅ |

**실제 구현** ([types.ts:150-173](../../types.ts#L150-L173)):

#### 수학팀장 (math_lead)
```typescript
math_lead: {
  'events.create': true,              // ✅ 일정 생성
  'events.edit_own': true,            // ✅ 일정 수정(본인)
  'events.attendance': true,          // ✅ 출석 관리
  'timetable.math.view': true,        // ✅ 수학 시간표 보기
  'timetable.math.edit': true,        // ✅ 수학 시간표 편집
  'timetable.english.view': true,     // ✅ 영어 시간표 보기
  'timetable.english.edit': false,    // ❌ 영어 시간표 편집
  'system.classes.view': true,        // ✅ 수업 목록 보기
  'system.classes.edit': true,        // ✅ 수업 목록 편집
}
```

#### 영어팀장 (english_lead)
```typescript
english_lead: {
  'events.create': true,              // ✅ 일정 생성
  'events.edit_own': true,            // ✅ 일정 수정(본인)
  'events.attendance': true,          // ✅ 출석 관리
  'timetable.math.view': true,        // ✅ 수학 시간표 보기
  'timetable.math.edit': false,       // ❌ 수학 시간표 편집
  'timetable.english.view': true,     // ✅ 영어 시간표 보기
  'timetable.english.edit': true,     // ✅ 영어 시간표 편집
  'system.classes.view': true,        // ✅ 수업 목록 보기
  'system.classes.edit': true,        // ✅ 수업 목록 편집
}
```

**평가**: ✅ **100% 일치**

---

## 2. 누락된 내용

### 2.1. 상세 권한 목록 ⚠️ **문서에 누락**

**실제 구현**에는 문서의 비교표에 없는 권한들이 더 있습니다:

| 권한 ID | 수학팀장 | 영어팀장 | 설명 |
|---------|---------|----------|------|
| `events.delete_own` | ✅ true | ✅ true | 본인 일정 삭제 |
| `events.delete_others` | ❌ false | ❌ false | 타인 일정 삭제 |
| `events.drag_move` | ✅ true | ✅ true | 일정 드래그 이동 |
| `buckets.edit_lower_roles` | ❌ false | ❌ false | 하위 역할 버킷 편집 |
| `buckets.delete_lower_roles` | ❌ false | ❌ false | 하위 역할 버킷 삭제 |
| `departments.view_all` | ✅ true | ✅ true | 모든 부서 보기 |
| `departments.create` | ❌ false | ❌ false | 부서 생성 |
| `departments.edit` | ❌ false | ❌ false | 부서 편집 |
| `departments.delete` | ❌ false | ❌ false | 부서 삭제 |
| `users.view` | ❌ false | ❌ false | 사용자 목록 보기 |
| `users.approve` | ❌ false | ❌ false | 사용자 승인 |
| `users.change_role` | ❌ false | ❌ false | 역할 변경 |
| `users.change_permissions` | ❌ false | ❌ false | 권한 변경 |
| `settings.access` | ❌ false | ❌ false | 설정 접근 |
| `settings.holidays` | ❌ false | ❌ false | 공휴일 설정 |
| `settings.role_permissions` | ❌ false | ❌ false | 역할 권한 설정 |

**문서 평가**: ⚠️ **주요 권한만 표시, 전체 권한 목록 누락**

---

### 2.2. 사용 예시 및 시나리오 ❌ **문서에 없음**

**실제 사용 시나리오** (코드에서 유추):
- 수학팀장이 수학 시간표를 편집하는 경우
- 영어팀장이 영어 시간표를 편집하는 경우
- 팀장이 자신의 일정만 관리하는 경우

**문서 평가**: ❌ **사용 예시 완전히 누락**

---

### 2.3. 권한 설정 방법 상세 ❌ **문서에 부족**

**문서 내용** (Line 40-42):
```
1. 설정 → 역할 권한 탭에서 새 역할 확인 가능
2. 설정 → 사용자 관리에서 사용자에게 역할 할당 가능
3. 권한은 역할 권한 탭에서 세부 조정 가능
```

**필요한 상세 정보**:
- 역할 할당 UI 스크린샷 또는 상세 설명
- 권한 세부 조정 방법
- 역할별 접근 가능한 메뉴 목록

**문서 평가**: ⚠️ **개념만 언급, 상세 절차 부족**

---

### 2.4. 다른 역할과의 비교 ❌ **문서에 없음**

**문서 현황**: 수학팀장 vs 영어팀장 비교만 있음

**필요한 비교**:
- 수학팀장 vs EDITOR
- 영어팀장 vs EDITOR
- 수학팀장 vs USER
- 팀장 vs MANAGER

**문서 평가**: ❌ **다른 역할과의 비교 없음**

---

### 2.5. Firestore Security Rules 관련 ⚠️ **문서에 간략히만 언급**

**문서 내용** (Line 46):
```
Firestore Security Rules는 기존 구조 유지 (클라이언트 측 권한 체크 활용)
```

**필요한 정보**:
- 왜 클라이언트 측 권한 체크를 사용하는지
- 보안 위험은 없는지
- 서버 측 규칙 추가 필요 여부

**문서 평가**: ⚠️ **중요한 보안 정보인데 설명 부족**

---

## 3. 업데이트 권장 사항

### 3.1. 섹션 추가: "전체 권한 목록"

**추가할 내용**:
```markdown
## 전체 권한 목록

### 공통 권한 (수학팀장 & 영어팀장)

| 권한 ID | 설명 | 값 |
|---------|------|:--:|
| `events.create` | 일정 생성 | ✅ |
| `events.edit_own` | 본인 일정 수정 | ✅ |
| `events.delete_own` | 본인 일정 삭제 | ✅ |
| `events.drag_move` | 일정 드래그 이동 | ✅ |
| `events.attendance` | 출석 관리 | ✅ |
| `departments.view_all` | 모든 부서 보기 | ✅ |
| `system.classes.view` | 수업 목록 보기 | ✅ |
| `system.classes.edit` | 수업 목록 편집 | ✅ |

### 차별화 권한 (팀별 차이)

| 권한 ID | 수학팀장 | 영어팀장 |
|---------|:-------:|:-------:|
| `timetable.math.view` | ✅ | ✅ |
| `timetable.math.edit` | ✅ | ❌ |
| `timetable.english.view` | ✅ | ✅ |
| `timetable.english.edit` | ❌ | ✅ |

### 제한된 권한 (모두 false)

| 권한 분류 | 설명 |
|----------|------|
| 타인 일정 편집/삭제 | `events.edit_others`, `events.delete_others` |
| 부서 관리 | `departments.create/edit/delete` |
| 사용자 관리 | `users.view/approve/change_role/change_permissions` |
| 시스템 설정 | `settings.access/holidays/role_permissions` |
| 버킷 관리 | `buckets.edit_lower_roles`, `buckets.delete_lower_roles` |
```

---

### 3.2. 섹션 추가: "역할 비교표"

**추가할 내용**:
```markdown
## 역할 비교표

### 시간표 관련 권한

| 역할 | 수학 시간표 | 영어 시간표 | 통합 시간표 | 시뮬레이션 모드 |
|------|:----------:|:----------:|:-----------:|:-------------:|
| MASTER | 편집 | 편집 | 편집 | ✅ |
| ADMIN | 편집 | 편집 | 편집 | ✅ |
| MANAGER | 보기 | 편집 | 보기 | ✅ |
| EDITOR | 보기 | 보기 | 보기 | ❌ |
| **수학팀장** | **편집** | **보기** | **보기** | **❌** |
| **영어팀장** | **보기** | **편집** | **보기** | **❌** |
| USER | 보기 | 보기 | 보기 | ❌ |

### 일정 관리 권한

| 역할 | 일정 생성 | 본인 일정 편집 | 타인 일정 편집 | 일정 드래그 |
|------|:--------:|:-------------:|:-------------:|:-----------:|
| MANAGER | ✅ | ✅ | ✅ | ✅ |
| EDITOR | ✅ | ✅ | ❌ | ✅ |
| **수학팀장** | **✅** | **✅** | **❌** | **✅** |
| **영어팀장** | **✅** | **✅** | **❌** | **✅** |
| USER | ✅ | ✅ | ❌ | ✅ |

**핵심 차이점**:
- 팀장은 EDITOR와 일정 관리 권한은 동일
- 팀장은 자신의 과목 시간표만 편집 가능
- 팀장은 수업 목록(classes)을 편집 가능 (EDITOR는 불가)
```

---

### 3.3. 섹션 추가: "사용 시나리오"

**추가할 내용**:
```markdown
## 사용 시나리오

### 시나리오 1: 수학팀장의 하루

**상황**: 수학팀장이 새 학기 준비를 위해 시간표를 조정합니다.

**가능한 작업**:
1. ✅ 수학 시간표 열기 및 편집
2. ✅ 수업 목록에서 학생 추가/삭제
3. ✅ 본인 일정 생성 (팀 회의, 개인 일정)
4. ✅ 영어 시간표 열람 (편집 불가)

**불가능한 작업**:
- ❌ 영어 시간표 편집
- ❌ 타 강사 일정 수정
- ❌ 시뮬레이션 모드 사용
- ❌ 사용자 역할 변경

### 시나리오 2: 영어팀장의 하루

**상황**: 영어팀장이 신입생을 영어 수업에 배정합니다.

**가능한 작업**:
1. ✅ 영어 시간표 열기 및 편집
2. ✅ 수업 목록에서 학생 추가
3. ✅ StudentModal에서 학생 정보 수정
4. ✅ 본인 부서 일정 생성

**불가능한 작업**:
- ❌ 수학 시간표 편집
- ❌ 시뮬레이션 모드에서 작업
- ❌ 백업 복원
- ❌ 부서 생성/삭제

### 시나리오 3: 권한 충돌 방지

**상황**: 수학팀장과 영어팀장이 동시에 작업

**설계 의도**:
- ✅ 각 팀장은 자신의 과목만 편집 가능
- ✅ 서로의 시간표는 열람만 가능
- ✅ 수업 목록은 공통으로 편집 가능 (학생 데이터 공유)
- ✅ 일정은 본인 것만 수정 가능

**장점**:
- 권한 충돌 없음
- 명확한 책임 분리
- 상호 협력 가능 (수업 목록 공유)
```

---

### 3.4. 섹션 추가: "설정 방법 상세"

**추가할 내용**:
```markdown
## 설정 방법 상세

### 1. 역할 할당 방법

**경로**: 설정 → 사용자 관리

**단계**:
1. 사용자 목록에서 대상 사용자 선택
2. 역할 드롭다운 클릭
3. "수학팀장" 또는 "영어팀장" 선택
4. [저장] 버튼 클릭

**권한**:
- MASTER, ADMIN만 역할 할당 가능
- MANAGER는 역할 변경 불가

### 2. 권한 세부 조정

**경로**: 설정 → 역할 권한

**단계**:
1. "수학팀장" 또는 "영어팀장" 역할 선택
2. 권한 체크박스 ON/OFF
3. [저장] 버튼 클릭

**주의사항**:
- MASTER만 역할 권한 설정 가능
- 변경 사항은 즉시 적용됨
- 로그아웃/로그인 불필요

### 3. 역할 확인 방법

**UI 표시**:
- 헤더 우측 상단: 사용자 이름 옆에 역할 배지 표시
- 설정 페이지: 역할 레이블에 "수학팀장" 또는 "영어팀장" 표시

**기능 접근**:
- 수학 시간표: 수학팀장만 편집 버튼 활성화
- 영어 시간표: 영어팀장만 편집 버튼 활성화
- 수업 목록: 두 팀장 모두 편집 가능
```

---

### 3.5. 섹션 추가: "보안 고려사항"

**추가할 내용**:
```markdown
## 보안 고려사항

### Firestore Security Rules

**현재 구조**:
- 클라이언트 측 권한 체크 활용
- Firestore Rules는 기존 구조 유지

**설계 이유**:
1. **유연성**: 역할별 세부 권한 조정이 클라이언트에서 가능
2. **실시간 반영**: Firestore Rules 재배포 없이 권한 변경 가능
3. **기존 호환성**: 기존 7단계 역할 시스템과 완전 호환

**보안 고려**:
- ✅ 인증된 사용자만 접근 (Firebase Auth)
- ✅ 클라이언트 코드에서 권한 체크
- ✅ UI 레벨에서 버튼 비활성화
- ⚠️ 악의적 사용자가 직접 API 호출 시 서버 측 검증 없음

**권장 사항** (선택):
- 중요한 작업(예: 시간표 편집)은 서버 측 검증 추가 고려
- Firebase Cloud Functions로 역할 검증 로직 구현 가능

### 권한 상속

**계층 구조**:
```
MASTER (최고 권한)
  ↓
ADMIN
  ↓
MANAGER
  ↓
EDITOR
  ↓
수학팀장 ← 특수 권한 (수학 시간표 편집)
  ↓
영어팀장 ← 특수 권한 (영어 시간표 편집)
  ↓
USER
  ↓
VIEWER
  ↓
GUEST (최소 권한)
```

**권한 상속 규칙**:
- 상위 역할은 하위 역할의 모든 권한 보유
- 팀장은 EDITOR와 동일한 기본 권한 + 과목별 편집 권한
- MASTER는 모든 권한 보유 (hardcoded)
```

---

### 3.6. 섹션 추가: "FAQ"

**추가할 내용**:
```markdown
## FAQ (자주 묻는 질문)

### Q1. 수학팀장과 영어팀장의 차이점은 무엇인가요?
**A.** 핵심 차이는 **시간표 편집 권한**입니다:
- 수학팀장: 수학 시간표만 편집 가능
- 영어팀장: 영어 시간표만 편집 가능
- 나머지 권한(일정 관리, 수업 목록 등)은 동일

### Q2. 팀장이 수업 목록을 편집하면 어떻게 되나요?
**A.** 수업 목록(`수업목록` 컬렉션)은 **공통 데이터**입니다:
- 수학팀장과 영어팀장 모두 편집 가능
- 변경 사항은 양쪽 팀장에게 모두 반영됨
- 학생 데이터 공유를 통해 협업 가능

### Q3. EDITOR와 팀장의 차이는 무엇인가요?
**A.** 팀장은 EDITOR보다 **더 많은 권한**을 가집니다:
- EDITOR: 시간표 보기만 가능, 수업 목록 편집 불가
- 팀장: 자신의 과목 시간표 편집 가능, 수업 목록 편집 가능

### Q4. 한 사용자가 수학팀장과 영어팀장을 동시에 할 수 있나요?
**A.** 아니요, **하나의 역할만 할당** 가능합니다:
- 시스템은 사용자당 하나의 역할만 지원
- 두 과목 모두 편집이 필요하면 ADMIN 또는 MANAGER 역할 부여

### Q5. 팀장이 시뮬레이션 모드를 사용할 수 있나요?
**A.** 아니요, 시뮬레이션 모드는 **MASTER, ADMIN, MANAGER만** 사용 가능합니다:
- 팀장은 실시간 모드에서만 편집 가능
- 안전한 테스트는 상위 역할이 담당

### Q6. 팀장 역할을 어떻게 확인하나요?
**A.** 다음 위치에서 확인 가능합니다:
- 헤더 우측 상단: 사용자 이름 옆 역할 배지
- 설정 → 사용자 관리: 사용자 목록의 역할 컬럼
- 설정 → 역할 권한: 역할 드롭다운

### Q7. 팀장 권한을 커스터마이징할 수 있나요?
**A.** 네, **MASTER 계정**으로:
- 설정 → 역할 권한 탭에서 세부 권한 조정 가능
- 예: 수학팀장에게 영어 시간표 보기 권한 제거 가능
- 변경 사항은 즉시 적용됨
```

---

## 4. 긍정적 평가

### 4.1. 간결한 요약 ✅
- 핵심 내용만 담은 명료한 문서
- 역할 계층 구조 다이어그램 명확
- 권한 비교표 직관적

### 4.2. 코드와 완벽 일치 ✅
- 문서의 모든 내용이 코드와 100% 일치
- 오류나 불일치 사항 전무
- 역할 이름, 권한 ID 모두 정확

### 4.3. 핵심 수정 파일 명시 ✅
- types.ts 파일 명확히 언급
- 수정 항목 간결히 나열
- 참조 파일 경로 포함

---

## 5. 최종 권장사항

### 5.1. 즉시 업데이트 (High Priority)

**추가할 섹션** (예상 소요 시간: 60분):
1. ✅ **전체 권한 목록** (15분)
2. ✅ **역할 비교표** (15분)
3. ✅ **사용 시나리오** (15분)
4. ✅ **FAQ** (15분)

**업데이트 후 예상 점수**: **A (90점)**

---

### 5.2. 선택적 개선 (Medium Priority)

**추가 가능 섹션** (예상 소요 시간: 45분):
1. **설정 방법 상세** (20분)
2. **보안 고려사항** (15분)
3. **UI 스크린샷** (10분)

**업데이트 후 예상 점수**: **A+ (95점)**

---

### 5.3. 문서 업데이트 우선순위

| 우선순위 | 항목 | 예상 시간 | 중요도 | 이유 |
|---------|------|----------|--------|------|
| P0 | 전체 권한 목록 | 15분 | CRITICAL | 사용자가 모든 권한을 알아야 함 |
| P0 | 역할 비교표 | 15분 | CRITICAL | 다른 역할과 차이 명확화 필요 |
| P1 | 사용 시나리오 | 15분 | HIGH | 실제 사용 예시 필수 |
| P1 | FAQ | 15분 | HIGH | 예상 질문 선제 대응 |
| P2 | 설정 방법 상세 | 20분 | MEDIUM | 사용자 편의성 향상 |
| P2 | 보안 고려사항 | 15분 | MEDIUM | 관리자 이해 필요 |
| P3 | UI 스크린샷 | 10분 | LOW | 시각적 가이드 |

**총 예상 시간**: 105분 (1시간 45분)

---

## 6. 문서-코드 일치도 요약

### 6.1. 일치하는 항목 ✅

| 항목 | 일치도 | 비고 |
|------|--------|------|
| UserRole 타입 | 100% | 완벽 일치 |
| ROLE_HIERARCHY | 100% | 완벽 일치 |
| ROLE_LABELS | 100% | 완벽 일치 |
| 권한 비교표 | 100% | 주요 권한 모두 일치 |
| 수정 파일 목록 | 100% | types.ts 정확히 명시 |

**전체 일치도**: **100%** (완벽)

### 6.2. 문서 완성도

| 항목 | 점수 | 평가 |
|------|------|------|
| 정확도 | 100/100 | 완벽 (코드와 100% 일치) |
| 완성도 | 60/100 | 보통 (기본 정보만 있음) |
| 상세도 | 50/100 | 부족 (사용 예시, FAQ 없음) |
| 가독성 | 90/100 | 우수 (간결하고 명확) |

**전체 평가**: **B+ (75점)**

---

## 7. 최종 평가

### 7.1. 현재 상태

**강점**:
- ✅ 코드와 100% 일치
- ✅ 간결하고 명확한 요약
- ✅ 핵심 권한 비교표 제공

**약점**:
- ❌ 상세 권한 목록 부족
- ❌ 사용 예시 없음
- ❌ 다른 역할과 비교 없음
- ❌ 보안 고려사항 간략

### 7.2. 권장 조치

✅ **문서 상세화 권장** - 105분 소요 예상

**업데이트 우선순위**:
1. **P0** (30분): 전체 권한 목록 + 역할 비교표
2. **P1** (30분): 사용 시나리오 + FAQ
3. **P2** (35분): 설정 방법 상세 + 보안 고려사항

**업데이트 후 예상 점수**: **A (90점)** → **A+ (95점)**

---

## 8. 참고 문서

- **원본 문서**: [team_leader_roles.md](./team_leader_roles.md)
- **구현 파일**: [types.ts](../../types.ts)
- **관련 기능**:
  - 영어 시간표 시스템
  - 수학 시간표 시스템
  - 수업 목록 관리

---

## 9. 변경 이력

| 날짜 | 버전 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| 2026-01-02 | 1.0 | 팀장 역할 시스템 문서 검증 보고서 작성 | AI Assistant |

---

**보고서 끝**

**상태**: ✅ **검증 완료 - 문서 상세화 권장**

**다음 단계**: 우선순위 P0-P1 항목 업데이트 (60분)
